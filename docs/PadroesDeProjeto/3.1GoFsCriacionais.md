# 3.1. Modulo Padroes de Projeto GoFs Criacionais

## Introducao
Os padroes criacionais catalogados pelo Gang of Four oferecem estrategias para controlar como objetos sao instanciados, reduzindo acoplamento e promovendo extensibilidade. No contexto do Carona Amiga, o fluxo de notificacoes para passageiro e motorista evolui com frequencia: surgem novos tipos de mensagem, canais de envio e regras de negocio. Adotar um padrao criacional permite que a equipe acrescente variacoes sem refatorar todo o codigo de orquestracao. Esta secao registra como utilizamos o padrao **Factory Method** para atender essa necessidade, a partir do artefato compilado publicado no diretorio `target`.

## Metodologia
O estudo começou com a leitura das histórias de sprint que tratam de notificações (solicitação, confirmação e rejeição) para identificar onde a criação de objetos estava gerando acoplamento. Com esse panorama, realizamos uma discussão técnica com a equipe comparando os padrões criacionais do GoF, avaliando quais atendiam melhor aos princípios SOLID que já seguimos. A partir daí prototipamos o Factory Method diretamente no código Java, garantindo que o exemplo compilasse e fosse empacotado pelo Maven. Em seguida produzimos o jar executável `target/factory-demo-1.0.0-SNAPSHOT.jar`, cuja execução demonstra o comportamento esperado do padrão. Por fim, registramos as evidências e reflexões neste documento para orientar expansões futuras.

## O que é um GoF Criacional?
Os GoFs criacionais resolvem problemas relacionados ao *como* e *quando* instanciar objetos. Em vez de espalhar construtores concretos pelo sistema, os padroes encapsulam o processo de criacao para que clientes dependam apenas de abstracoes. Isso torna o codigo aderente a principios como Aberto/Fechado (adicionamos novos tipos sem modificar clientes) e Inversao de Dependencia (camadas superiores conversam com interfaces). Os principais padroes deste grupo sao:
- **Factory Method**: delega a subclasses a decisao de qual produto concreto instanciar.
- **Abstract Factory**: agrupa varios factory methods para criar familias de objetos relacionados.
- **Builder**: separa a montagem passo a passo da representacao final.
- **Prototype**: cria objetos por clonagem de instancias preexistentes.
- **Singleton**: garante uma unica instancia globalmente acessivel.

## Aplicacao do Factory Method no Carona Amiga
O exemplo que acompanha esta documentacao esta disponivel no artefato compilado `target/factory-demo-1.0.0-SNAPSHOT.jar`, gerado a partir do codigo Java do repositorio. Ao executar `java -jar target/factory-demo-1.0.0-SNAPSHOT.jar`, o console exibe as mensagens correspondentes a cada tipo de notificacao, comprovando o fluxo do Factory Method.

### Estrutura das classes (classes compiladas em `target/classes`)
- **Produto abstrato**: `factory/produtos/Notificacao.class` define o contrato `void enviar()` que todos os produtos concretos implementam.
- **Produtos concretos**:
  - `factory/produtos/NotificacaoSolicitacaoCarona.class` envia a mensagem para novas solicitacoes.
  - `factory/produtos/NotificacaoConfirmacaoCarona.class` comunica confirmacoes do motorista.
  - `factory/produtos/NotificacaoRejeicaoCarona.class` informa recusas de carona.
- **Creator abstrato**: `factory/fabricas/NotificacaoFactory.class` contem o metodo template `enviarNotificacao(String tipo)` e declara o factory method protegido `criarNotificacao`.
- **Creator concreto**: `factory/fabricas/GeradorNotificacaoCarona.class` sobrescreve `criarNotificacao`, valida o tipo recebido e instancia o produto adequado. Tipos desconhecidos levam a `IllegalArgumentException`, garantindo feedback rapido.
- **Cliente**: `factory/Main.class` utiliza apenas a abstracao `NotificacaoFactory` para disparar notificacoes, sem conhecer classes concretas.

### Fluxo de execucao
1. `factory/Main.class` instancia `GeradorNotificacaoCarona` e chama `enviarNotificacao` para `SOLICITACAO`, `CONFIRMACAO` e `REJEICAO`.
2. O creator concreto interpreta o tipo e cria a implementacao correta de `Notificacao` (Factory Method em acao).
3. A classe base `NotificacaoFactory` invoca `enviar()` no produto retornado, executando o comportamento especifico sem acoplamento ao tipo concreto.
4. Ao adicionar um novo tipo de notificacao, basta criar uma nova implementacao de `Notificacao` e estender a logica de decisao do factory, mantendo o cliente intacto.



### Evidencias tecnicas
- Arquivo de build: `pom.xml` define o empacotamento Maven com `maven-jar-plugin` registrando `factory.Main` como `Main-Class`, o que gera o jar executavel no diretorio `target`.
- Comandos para reproducao:
  ```bash
  mvn clean package
  java -jar target/factory-demo-1.0.0-SNAPSHOT.jar
  ```
- Saida esperada: mensagens impressas confirmando o envio das notificacoes de solicitacao, confirmacao e rejeicao, caracterizando o comportamento do Factory Method.



## Detalhamento do Singleton
O padrao **Singleton** resolve o problema de garantir que uma classe possua uma unica instancia acessivel globalmente. Ele e muito citado quando falamos de gerenciadores de conexao, provedores de configuracao, caches compartilhados ou objetos que coordenam recursos escassos do sistema.

### Intencao
- Controlar explicitamente o ciclo de vida de um objeto unico.
- Oferecer um ponto de acesso global a essa instancia, evitando que cada cliente precise gerenci-la manualmente.
- Manter a aplicacao consistente ao evitar copias divergentes de um mesmo estado compartilhado.

### Componentes tipicos
- **Classe Singleton**: encapsula atributos e comportamentos compartilhados, com construtor privado para impedir instanciacoes diretas.
- **Campo estatico**: armazena a unica instancia conhecida da classe.
- **Metodo de acesso**: cria a instancia quando necessario e devolve sempre a mesma referencia.
- **Sincronizacao opcional**: garante seguranca em ambientes multithread sem custo elevado.

### Beneficios
- Centraliza a configuracao de um recurso compartilhado, facilitando manutencao.
- Reduz sobrecarga de instanciacao quando o objeto e pesado ou depende de configuracao complexa.
- Permite aplicar inicializacao tardia, postergando custo de criacao ate que o objeto seja realmente necessario.



## Detalhamento do Builder
O padrao **Builder** foi concebido para separar a construcao de um objeto complexo da sua representacao final. Ele permite montar diferentes representacoes do mesmo produto reutilizando a mesma logica passo a passo.

### Intencao
- Encapsular passos de montagem que podem variar conforme o contexto, mantendo a logica de criacao isolada do produto final.
- Evitar construtores com grande quantidade de parametros, especialmente quando ha muitos campos opcionais.
- Garantir que objetos sejam entregues em estado valido, consolidando validacoes no metodo `build()`.

### Componentes tipicos
- **Produto**: classe que representa a entidade final. Pode ser mutavel durante a construcao, mas normalmente torna-se imutavel ao fim do processo.
- **Builder**: define a interface com os passos de montagem. Cada metodo devolve o proprio builder permitindo encadeamento.
- **Builders concretos**: implementam os passos para montar variacoes especificas do produto.
- **Diretor** (opcional): orquestra a ordem em que os passos sao aplicados, encapsulando roteiros padrao.

### Beneficios
- Melhora legibilidade ao substituir construtores cheios por chamadas nomeadas para cada parametro.
- Facilita a criacao de variacoes do mesmo objeto sem explodir combinacoes de construtores ou hierarquias de subclasses.
- Minimiza o risco de estados invalidos, ja que todo o processo passa pelo metodo `build()`.
- Ajuda em testes automatizados ao padronizar a construcao de objetos.



## Referencias
- Gamma, E.; Helm, R.; Johnson, R.; Vlissides, J. *Design Patterns: Elements of Reusable Object-Oriented Software*. Addison-Wesley, 1994.
- Freeman, E.; Robson, E. *Head First Design Patterns*. O'Reilly Media, 2021.

## Historico de versoes
| Versao | Data | Responsaveis | Revisor |
| --- | --- | --- | --- |
| 1.1 | 2025-10-20 | Codex IA | Inclusao das secoes de Singleton e Builder |
| 1.0 | 2025-04-15 | Kaleb Macedo | Documento original sobre GoFs criacionais |
